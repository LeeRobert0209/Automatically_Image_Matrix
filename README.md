# ImageMatrix (影像矩阵)

**ImageMatrix** 是一款基于 Python 和 PyQt6 开发的高效桌面图像处理工具。它集成了**智能拼图**与**智能切图**两大核心功能，专为设计师、电商运营和内容创作者打造。

## 核心功能

### 1. 智能拼图 (Merge)
将多张图片自动拼接成一张或多张长图，完美适配电商详情页或长图文排版。
*   **拖拽排序**：支持直接拖拽图片文件，自动按名称排序。
*   **多模式拼接**：
    *   **垂直拼接 (Vertical)**：将图片从上到下拼接成一张长图。
    *   **水平拼接 (Horizontal)**：将图片从左到右拼接，自动统一高度。
    *   **宫格拼接 (Grid)**：**[NEW]** 将图片按 M x N 网格拼接。支持 2x2, 3x3 等预设及自定义。
*   **多格式导出**：**[NEW]** 支持一键导出为 **JPG**、**PNG** 或 **PDF** 文件。
    *   **PDF导出**：直接将多张图片拼接后生成高质量 PDF，免去转换压缩烦恼。
*   **灵活输出**：支持**原图**、**750px**、**1080px** 或 **自定义宽度**导出。
*   **分组拼接**：可设置将所有图片拼成 1 张长图，或自动分割成 N 张（便于文件过大时分段，主要用于垂直/水平模式）。

### 2. 智能切图 (Slice) [NEW]
将一张图片智能裁切成多张小图，支持**水平**、**垂直**和**宫格**三种模式，全能适配。
*   **多模式切分**：
    *   **水平切分**：将长图横向切断（如详情页切图）。
    *   **垂直切分**：将宽图纵向切断（如对半切图）。
    *   **宫格切图 (Grid)**：**[NEW]** 将大图切分成 M x N 的网格。支持 **2x2, 3x3** 等快速预设，也支持自定义行数/列数。
*   **智能自动吸附 (Smart Snap)**：独创的内容感知算法，**自动避开文字、产品和复杂图案**（仅限水平/垂直模式）。
*   **交互式预览**：宫格模式下支持**1:1 细节预览**，悬停切分线即可查看高清像素细节。
*   **多格式导出**：**[NEW]** 同样支持导出为 **JPG**、**PNG** 或 **PDF**（每张切片保存为独立的 PDF 文件）。
*   **自定义切分**：自由拖动滑块选择切分数量（1-50份）。
*   **尺寸调整**：支持在切图的同时调整图片宽度。

### 3. 便捷管理 (Management)
*   **右键菜单**：文件列表中支持**右键重命名**和**删除**，方便整理素材。
*   **快捷键支持**：选中文件按 `Delete` 键即可快速移除。
*   **批量重命名**：同时选中多个文件进行重命名，会自动添加序号（例如 `Image_001.jpg`）。

## 快速开始

### 运行程序
双击根目录下的脚本即可启动：
`启动ImageMatrix工具.bat`

> **提示**：如果您的 Python 环境路径不固定（例如在公司和家里不同），可以修改根目录下的 `config.ini` 文件。
> 将 `python_path=` 后的内容修改为您当前电脑上 Python解释器的完整路径即可。
> **支持直接复制粘贴路径**（例如 `C:\Anaconda3\python.exe`），无需添加双反斜杠。

### 使用指南

#### 拼图模式 (Merge)
1. 切换到 **“拼图 (Merge)”** 标签页。
2. 将图片拖入列表（支持右键重命名/删除）。
3. **选择拼接模式**：
    *   **垂直**：适合长图。
    *   **水平**：适合横幅。
    *   **宫格**：适合朋友圈九宫格等。
4. **选择导出格式**：**JPG / PNG / PDF**（推荐文档用 PDF）。
5. 设置**导出宽度**和**拼接数量**（宫格模式除外）。
6. 点击 **“开始拼接 (保存到桌面)”**。

#### 切图模式 (Slice)
1. 切换到 **“切图 (Slice)”** 标签页。
2. 将图片拖入列表。
3. **选择切分模式**（水平 / 垂直 / 宫格）。
    *   **宫格模式**：点击下方预设按钮（如 3x3），或点击“预览效果”检查切分线。
4. **选择导出格式**：**JPG / PNG / PDF**。
5. 设置切分数量或参数。
6. 点击 **“开始切图 (保存到桌面)”**。

## 环境依赖
如果需要查看源码或自行运行 Python 脚本：
```bash
pip install -r requirements.txt
```
*(主要依赖库: PyQt6, Pillow)*
